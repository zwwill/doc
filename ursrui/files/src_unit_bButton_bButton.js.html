<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>src/unit/bButton/bButton.js - URS RUI</title>
  
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="stylesheet" href="../assets/vendor/bootstrap/css/bootstrap.min.css">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
</head>
<body class="yui3-smart" _assetsPath="../assets">
 <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container-fluid">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
               <a class="navbar-brand mainlogo" href="/urs-rui/doc/">
             
            <img alt="URS RUI" src="../assets/img/logo.png" title="URS RUI">
            
          </a>
            </div>
            <div id="navbar" class="navbar-collapse collapse">
                 <ul class="nav navbar-nav">
                    
                    <li><a href="/urs-rui/doc/ui-standard/index.html">URS UI规范</a>
                    </li>
                    
                    <li><a href="https://g.hz.netease.com/urs-front/urs-rui">GitLab</a>
                    </li>
                    
                    <li><a href="http://npm.hz.netease.com/package/@netease/urs-rui">NPM</a>
                    </li>
                    
                </ul>
            </div>
        </div>
    </nav>
    <div id="sidebar">
    <h3>元件 / 模块</h3>
        <div id="api-tabview-filter">
            <input id='txtSearch' type="search" class="form-control" placeholder="Type to Filter Components">
        </div>
        <dl id="sidebar_list">
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <p>Module</p>
                </dt>
                <dd>
                    <ul>
                   
                       <li>
                            
                           <a href="../classes/H5MbInput.html">H5MbInput</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/H5Tab.html">H5Tab</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/bMbInput.html">bMbInput</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/PwdInput.html">PwdInput</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/SmsInput[待整理].html">SmsInput[待整理]</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <p>Sass</p>
                </dt>
                <dd>
                    <ul>
                   
                       <li>
                            
                           <a href="../classes/bCommon.scss.html">bCommon.scss</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/_config.scss.html">_config.scss</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <p>Unit</p>
                </dt>
                <dd>
                    <ul>
                   
                       <li>
                            
                           <a href="../classes/Alert.html">Alert</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Button.html">Button</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Captcha.html">Captcha</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Gotop.html">Gotop</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/bInput.html">bInput</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Loading.html">Loading</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Menu.html">Menu</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Pager.html">Pager</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Quest.html">Quest</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/SelectInput.html">SelectInput</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Slide.html">Slide</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Tab.html">Tab</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Toast.html">Toast</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                    </ul>
                </dd>
             
        </dl>
</div>
   
    <div class="stdoc-content">
        <div class="apidocs">
            <div id="docs-main">
                <div class="content">
                    <div class="page-header">
    <h1>src/unit/bButton/bButton.js <small>File</small></h1>
</div>

<div class="file">
    <pre class="prettyprint linenums" id='src_code'>

/**
 * **单元组件 - 按钮[Button]**&lt;br&gt;
 * 基础的按钮封装组件&lt;br&gt;
 * 支持按钮上锁、loading、倒计时功能&lt;br&gt;
 * **使用方法：**&lt;br&gt;
 * &#x60;&#x60;&#x60;
 * 【引用关键字】
 * require(&#x27;urs-rui/src/unit/button/button.js&#x27;)
 * &#x60;&#x60;&#x60;
 * &#x60;&#x60;&#x60;
 * 【组件标签】
 * &lt;bButton clazz=&quot;bButton-sms f-fl&quot; enableTip=&quot;获取验证码&quot;&gt;&lt;/bButton&gt;
 *
 * &#x60;&#x60;&#x60;
 * @class Button
 * @main Unit
 * @constructor
 * @demo unit/bButton/demo-1.html {可用状态}
 * @demo unit/bButton/demo-2.html {锁定状态}
 * @demo unit/bButton/demo-3.html {Loading状态}
 * @show true
 * @author 黄笛
 * @revise 通用性优化，注释撰写 [2017-08-03] [张威]
 * @revise 调整对外API，去掉可重置状态时文字（回归enableTip） [2017-09-25] [黄笛]
 */

/*================组件可传参数==================*/
/**
 * 按钮可用时显示文字
 * @property enableTip
 * @default 按钮
 * @type String
 */

/**
 * 倒计时状态时显示文字，&#x60;&#x60;[count]&#x60;&#x60;为预留计时位置
 * @property countingTip
 * @default [count]s
 * @type String
 */

/**
 * 锁定、禁用状态时显示文字
 * @property disableTip
 * @default 状态重置
 * @type String
 */

/**
 * 锁定状态计时时长
 * @property count
 * @default 30
 * @type Number
 */

/*================可发起/监听事件==================*/
/**
 * 锁定计时开始回调
 * @event countbegin
 * @example &lt;Button on-countbegin={ function(_obj){} } /&gt;
 * @return {Object} {sender: e}
 */
/**
 * 锁定计时结束回调
 * @event countend
 * @example &lt;Button on-countend={ function(_obj){} } /&gt;
 * @return {Object} {sender: e}
 */
/**
 * 点击事件
 * @event click
 * @return {Object} {sender: e}
 */

&#x27;use strict&#x27;

import &#x27;./bButton.scss&#x27;
import tpl from &#x27;./bButton.rgl&#x27;

import Base from &#x27;../../base/component&#x27;

var Button = Base.extend({
    name: &#x27;bButton&#x27;,
    template: tpl,
    config() {
        this.defaults({
            enableTip: &#x27;提交&#x27;,
            countingTip: &#x27;[count]s&#x27;,
            disableTip: &#x27;提交中...&#x27;,
            count: 30,
            disabled: 0,
            loading: 0,
            tip:&#x27;&#x27;
        });
        this.supr();  
    },
    init() {
        this.data.tip = this.data.enableTip;
    },
    _onClick (_event){
        _event.preventDefault();
        
        this.$emit(&#x27;click&#x27;,{
            sender: this
        })
    },
    /**
     * 设定按钮锁定状态：loading 或 倒计时锁定
     * @method setLock
     * @param {Object} opt {loading:0,count:0,tip:&#x27;XXX&#x27;}
     * @return undefined
     */
    setLock (opt){
        let _opt = opt || {};
        this.data.disabled = 1;
        // 是否loading
        if(_opt.loading){
            this.data.loading = 1;
        }else{
            this.data.loading = 0;

        }
        // 是否倒计时
        if(_opt.count){
            // 倒计时文案采用countingTip走倒计时流程
            this.countDown();
        }else{
            // 仅锁定，采用disableTip
            this.data.tip = _opt.tip || this.data.disableTip;
        }
        this.$update();
    },
    /**
     * 还原按钮状态：按钮可用，文案恢复为enableTip，
     * loading、倒计时清除
     * @method unLock
     * @return undefined
     */
    unLock (){
        // 还原按钮状态
        this.data.disabled = 0;
        this.data.tip = this.data.enableTip;
        this.data.loading = 0;
        clearTimeout(this.timer);
        this.$update();
    },
    countDown: (function (){
        var _count = 10
        
        var t = function(){
            this.timer = setTimeout(()=&gt;{
                _count --;
                this.data.tip = this.data.countingTip.replace(&#x27;[count]&#x27;,_count);
                this.$update();
                
                if(_count &lt; 0){
                    this.$emit(&#x27;countend&#x27;,{
                        sender:this,
                    })
                    this.unLock();
                    this.$update();
                    clearTimeout(this.timer);
                    return;
                }
                t.apply(this);
            },1000)
        }
        return function(){
            this.$emit(&#x27;countbegin&#x27;,{
            sender:this,
            });
            _count = this.data.count;
            _count --;
            this.data.tip = this.data.countingTip.replace(&#x27;[count]&#x27;,_count);
            this.$update();
            t.apply(this);
        }
    })()
});

export default Button;
    </pre>
</div>

                </div>
            </div>
        </div>
    </div>
<a id="gotoTop" class='well well-small' href='#'>
    Top
</a>
<script src="../assets/vendor/jquery/jquery-1.8.2.min.js"></script>
<script src="../assets/vendor/bootstrap/js/bootstrap.min.js"></script>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script src="../assets/js/config.js"></script>
<script src="../assets/js/doc.js"></script>
</body>
</html>
