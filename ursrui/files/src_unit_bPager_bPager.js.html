<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>src/unit/bPager/bPager.js - URS RUI</title>
  
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="stylesheet" href="../assets/vendor/bootstrap/css/bootstrap.min.css">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
</head>
<body class="yui3-smart" _assetsPath="../assets">
 <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container-fluid">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
               <a class="navbar-brand mainlogo" href="/urs-rui/doc/">
             
            <img alt="URS RUI" src="../assets/img/logo.png" title="URS RUI">
            
          </a>
            </div>
            <div id="navbar" class="navbar-collapse collapse">
                 <ul class="nav navbar-nav">
                    
                    <li><a href="/urs-rui/doc/ui-standard/index.html">URS UI规范</a>
                    </li>
                    
                    <li><a href="https://g.hz.netease.com/urs-front/urs-rui">GitLab</a>
                    </li>
                    
                    <li><a href="http://npm.hz.netease.com/package/@netease/urs-rui">NPM</a>
                    </li>
                    
                </ul>
            </div>
        </div>
    </nav>
    <div id="sidebar">
    <h3>元件 / 模块</h3>
        <div id="api-tabview-filter">
            <input id='txtSearch' type="search" class="form-control" placeholder="Type to Filter Components">
        </div>
        <dl id="sidebar_list">
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <p>Module</p>
                </dt>
                <dd>
                    <ul>
                   
                       <li>
                            
                           <a href="../classes/H5MbInput.html">H5MbInput</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/H5Tab.html">H5Tab</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/bMbInput.html">bMbInput</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/PwdInput.html">PwdInput</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/SmsInput[待整理].html">SmsInput[待整理]</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <p>Sass</p>
                </dt>
                <dd>
                    <ul>
                   
                       <li>
                            
                           <a href="../classes/bCommon.scss.html">bCommon.scss</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/_config.scss.html">_config.scss</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <p>Unit</p>
                </dt>
                <dd>
                    <ul>
                   
                       <li>
                            
                           <a href="../classes/Alert.html">Alert</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Button.html">Button</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Captcha.html">Captcha</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Gotop.html">Gotop</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/bInput.html">bInput</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Loading.html">Loading</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Menu.html">Menu</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Pager.html">Pager</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Quest.html">Quest</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/SelectInput.html">SelectInput</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Slide.html">Slide</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Tab.html">Tab</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Toast.html">Toast</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                    </ul>
                </dd>
             
        </dl>
</div>
   
    <div class="stdoc-content">
        <div class="apidocs">
            <div id="docs-main">
                <div class="content">
                    <div class="page-header">
    <h1>src/unit/bPager/bPager.js <small>File</small></h1>
</div>

<div class="file">
    <pre class="prettyprint linenums" id='src_code'>
 /**
 * **单元组件 - 翻页器[bPager]**&lt;br&gt;
 * 基础的bPager封装组件&lt;br&gt;
 * **使用方法：**&lt;br&gt;
 * &#x60;&#x60;&#x60;
 * 【引用关键字】
 * require(&#x27;urs-rui/src/unit/bPager/bPager.js&#x27;)
 * &#x60;&#x60;&#x60;
 * &#x60;&#x60;&#x60;
 * 【组件标签】
 * &lt;bPager clazz=&quot;m-page&quot; ref=bPager total={total} limit={limit} currentPage={currentPage} on-page={this.onPage($event)}&gt;&lt;/bPager&gt;
 *
 * &#x60;&#x60;&#x60;
 * @class Pager
 * @main Unit
 * @constructor
 * @demo unit/bPager/demo-1.html {Pager}
 * @show true
 * @author cheng-lin@corp.netease.com
 */

 /*================组件可传参数==================*/

 /**
 * 外层样式
 * @property clazz
 * @default 
 * @type String
 */

 /**
 * 总条数
 * @property total
 * @default 0
 * @type Number
 */

 /**
 * 每页显示条数
 * @property limit
 * @default 10
 * @type Number
 */

 /**
 * 分隔符文案
 * @property ellipsis
 * @default ...
 * @type String
 */

 /**
 * 当前显示第几页
 * @property currentPage
 * @default 1
 * @type Number
 */

 /**
 * 三段式分页每段的数量
 * @property step
 * @default [1,3,1]
 * @type Array
 */

 /**
 * 上一页文案
 * @property prePage
 * @default 上一页
 * @type String
 */

 /**
 * 下一页文案
 * @property nextPage
 * @default 下一页
 * @type String
 */

 /*================可发起/监听事件==================*/
 /**
 * 选择页码
 * @event page
 * @example &lt;bPager on-page={ function(_obj){console.log(_obj.currentPage)} } /&gt;
 * @return {Object}
 */

&#x27;use strict&#x27;

import Regular from &#x27;regularjs&#x27;;
import tpl from &#x27;./bPager.rgl&#x27;;
import &#x27;./bPager.scss&#x27;;

let data = {
    limit:10,
    total:0,
    ellipsis:&#x27;...&#x27;,
    currentPage:1,
    step:[1,3,1],
    totalNumber:0,
    prePage:&#x27;&lt;&#x27;,
    nextPage:&#x27;&gt;&#x27;
};

let Pager = Regular.extend({
    template:tpl,
    name:&#x27;bPager&#x27;,
    config:function(){
        this.data = Object.assign(data,this.data);
        this.$watch(&#x27;total&#x27;,this.updatePage);
        this.$watch(&#x27;currentPage&#x27;,this.updatePage);
    },
    init:function(data){
        this.supr(data);
    },
    createArray:function(from,to){
        let l = to-from;
        let list = [];
        for(let i = 0; i&lt;=l; i++){
            list[i] = from;
            from++;
        }
        return list;
    },
    clearPages:function(){
        this.data.pagesOne = [];
        this.data.pagesTwo = [];
        this.data.pagesThree = [];
    },
    refreshPages:function(needSelect){
        var oneEnd,twoStart,twoEnd,threeStart;
        this.clearPages();
        if (this.data.pageTotal!=undefined){
            this.data.totalPage = parseInt(this.data.pageTotal);
        }else{
            this.data.totalPage = Math.ceil(this.data.total/this.data.limit);
        }
        if (this.data.totalPage &lt;= this.data.totalNumber){
            this.data.pagesOne = this.createArray(1,this.data.totalPage);
        }else{
            if (this.data.currentPage-this.step0-this.middle&lt;=1){
                // 前两段式
                oneEnd = this.step0+this.step1;
                twoStart = this.data.totalPage-this.step2+1;
                this.data.pagesOne = this.createArray(1,oneEnd);
                this.data.pagesTwo = this.createArray(twoStart,this.data.totalPage);
            }else if (this.data.currentPage+this.middle+this.step2&gt;=this.data.totalPage){
                // 后两段式
                oneEnd = this.step0;
                twoStart = this.data.totalPage-this.step2-this.step1+1;
                this.data.pagesOne = this.createArray(1,oneEnd);
                this.data.pagesTwo = this.createArray(twoStart,this.data.totalPage);
            }else{
                // 三段式
                if (this.isEven){
                    twoStart = this.data.currentPage-this.middle+1;
                    twoEnd = this.data.currentPage+this.middle;
                }else{
                    twoStart = this.data.currentPage-this.middle;
                    twoEnd = this.data.currentPage+this.middle;
                }
                threeStart = this.data.totalPage-this.step2+1;
                this.data.pagesOne = this.createArray(1,this.step0);
                this.data.pagesTwo = this.createArray(twoStart,twoEnd);
                this.data.pagesThree = this.createArray(threeStart,this.data.totalPage);
            }
        }
        if (needSelect){
            this.data.cPage = this.data.currentPage;
        }
        this.$update();
    },
    doSetPage:function(index){
        if (this.data.currentPage == index){
            return;
        }
        this.$emit(&#x27;page&#x27;,{currentPage:index});
        this.$update();
    },
    doPageOne:function(index){
        if (index == 1 &amp;&amp; this.data.currentPage&lt;this.data.totalPage){
            index = this.data.currentPage + index;
            this.doSetPage(index);
        }
        if (index == -1 &amp;&amp; this.data.currentPage&gt;1){
            index = this.data.currentPage + index;
            this.doSetPage(index);
        }
    },
    doPage:function(e){
        if (e.target &amp;&amp; e.target.dataset &amp;&amp; e.target.dataset.index){
            let index = parseInt(e.target.dataset.index);
            this.doSetPage(index);
        }
    },
    stringToNumber:function(obj){
        obj.currentPage = parseInt(obj.currentPage);
        obj.limit = parseInt(obj.limit);
        obj.total = parseInt(obj.total);
        return obj;
    },
    /**
     * 刷新翻页器
     * @method updatePage
     * @param {Object}
     * @return undefined
     */
    updatePage:function(data){
        this.data = Object.assign(this.data,data);
        this.data = this.stringToNumber(this.data);
        this.data.step.forEach((number,index)=&gt;{
            this[&#x27;step&#x27;+index] = number;
        })
        this.data.totalNumber = this.step0+this.step1+this.step2;
        // 默认非偶数
        this.isEven = 0;
        if (this.step1%2 ==0){
            this.isEven = 1;
        }
        this.middle = Math.floor(this.step1/2);
        this.refreshPages(1);
        this.$update();
    },
    /**
     * 设置当前页码
     * @method setPage
     * @param {Number} index 页码 ** *1* |2 | 3 **
     * @return undefined
     */
    setPage:function(index){
        index = parseInt(index);
        this.doSetPage(index);
    }
})

export default Pager;

    </pre>
</div>

                </div>
            </div>
        </div>
    </div>
<a id="gotoTop" class='well well-small' href='#'>
    Top
</a>
<script src="../assets/vendor/jquery/jquery-1.8.2.min.js"></script>
<script src="../assets/vendor/bootstrap/js/bootstrap.min.js"></script>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script src="../assets/js/config.js"></script>
<script src="../assets/js/doc.js"></script>
</body>
</html>
